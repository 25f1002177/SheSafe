{% extends "base.html" %}

{% block title %}Admin Dashboard - SheSafe{% endblock %}

{% block styles %}
<style>
    .pb-safe-area {
        padding-bottom: env(safe-area-inset-bottom);
    }
</style>
<script>
    tailwind.config = {
        darkMode: "class",
        theme: {
            extend: {
                colors: {
                    "admin-primary": "#0f49bd",
                    "rose-pink": "#e91e63",
                },
                fontFamily: {
                    "display": ["Public Sans"]
                },
                borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
            },
        },
    }
</script>
{% endblock %}

{% block content %}
<div class="bg-background-light dark:bg-background-dark min-h-screen -m-4">
    <!-- Top Navigation Bar -->
    <header class="sticky top-0 z-50 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800">
        <div class="flex items-center justify-between p-4 pb-3">
            <div class="flex items-center gap-3">
                <div class="size-10 rounded-full bg-admin-primary/20 flex items-center justify-center overflow-hidden border border-admin-primary/30">
                    <span class="material-symbols-outlined text-admin-primary">admin_panel_settings</span>
                </div>
                <div>
                    <h2 class="text-sm font-medium text-slate-500 dark:text-slate-400 leading-none mb-1">Welcome back,</h2>
                    <h1 class="text-lg font-bold leading-none">{{ user.name }}</h1>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button class="relative p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors">
                    <span class="material-symbols-outlined">notifications</span>
                    <span class="absolute top-2 right-2 flex h-2 w-2">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-rose-pink opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-rose-pink"></span>
                    </span>
                </button>
            </div>
        </div>
    </header>

    <main class="p-4 pb-24 max-w-md mx-auto">
        <!-- Section Title -->
        <div class="mb-4">
            <h2 class="text-xl font-bold tracking-tight">Overview Dashboard</h2>
            <p class="text-xs text-slate-500 dark:text-slate-400">Platform activity</p>
        </div>

        <!-- Metrics Grid -->
        <div class="grid grid-cols-2 gap-3 mb-6">
            <div class="flex flex-col gap-2 rounded-xl p-4 bg-white dark:bg-card-dark border border-slate-200 dark:border-slate-800 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-admin-primary">groups</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Total Users</p>
                    <p class="text-2xl font-bold mt-1">{{ user_count }}</p>
                </div>
            </div>
            <div class="flex flex-col gap-2 rounded-xl p-4 bg-white dark:bg-card-dark border border-slate-200 dark:border-slate-800 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-rose-pink">storefront</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Total Vendors</p>
                    <p class="text-2xl font-bold mt-1">{{ vendor_count }}</p>
                </div>
            </div>
            <div class="flex flex-col gap-2 rounded-xl p-4 bg-white dark:bg-card-dark border border-slate-200 dark:border-slate-800 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-amber-500">payments</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Total Revenue</p>
                    <p class="text-2xl font-bold mt-1">${{ "%.0f"|format(vendor_count * 54) }}</p>
                </div>
            </div>
            <div class="flex flex-col gap-2 rounded-xl p-4 bg-white dark:bg-card-dark border border-slate-200 dark:border-slate-800 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-admin-primary">pending_actions</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Pending</p>
                    <p class="text-2xl font-bold mt-1">{{ pending_vendors|length }}</p>
                </div>
            </div>
        </div>

        <!-- Pending Vendor Requests Section -->
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-bold">Pending Vendor Requests</h3>
            <a href="#" class="text-admin-primary text-sm font-semibold">View All</a>
        </div>

        <div class="flex flex-col gap-3">
            {% if pending_vendors %}
                {% for vendor in pending_vendors %}
                <div class="flex flex-col bg-white dark:bg-card-dark p-4 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-12 w-12 flex-shrink-0 bg-slate-200 flex items-center justify-center">
                            <span class="material-symbols-outlined text-slate-400">storefront</span>
                        </div>
                        <div class="flex-1 overflow-hidden">
                            <p class="text-base font-bold truncate">{{ vendor.business_name }}</p>
                            <p class="text-slate-500 dark:text-slate-400 text-sm truncate">{{ vendor.category }} â€¢ {{ vendor.user.name }}</p>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <form method="POST" action="{{ url_for('main.approve_vendor', vendor_id=vendor.id) }}" class="flex-1">
                            <button type="submit" class="w-full h-10 bg-admin-primary text-white rounded-lg text-sm font-bold transition-opacity hover:opacity-90 active:scale-[0.98]">
                                Approve
                            </button>
                        </form>
                        <form method="POST" action="{{ url_for('main.reject_vendor', vendor_id=vendor.id) }}" class="flex-1" onsubmit="return confirm('Are you sure you want to reject this vendor?');">
                            <button type="submit" class="w-full h-10 border border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-300 rounded-lg text-sm font-bold transition-colors hover:bg-slate-50 dark:hover:bg-slate-800 active:scale-[0.98]">
                                Reject
                            </button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="flex flex-col bg-white dark:bg-card-dark p-4 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm text-center">
                    <p class="text-slate-500 dark:text-slate-400">No pending vendor requests</p>
                </div>
            {% endif %}
        </div>
    </main>

    <!-- Bottom Navigation Bar (iOS Style) -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-background-dark/95 backdrop-blur-lg border-t border-slate-200 dark:border-slate-800 pb-safe-area z-50">
        <div class="flex justify-around items-center px-2 py-3">
            <a href="{{ url_for('main.admin_dashboard') }}" class="flex flex-col items-center gap-1 text-admin-primary">
                <span class="material-symbols-outlined">dashboard</span>
                <span class="text-[10px] font-bold uppercase tracking-tight">Overview</span>
            </a>
            <a href="#" class="flex flex-col items-center gap-1 text-slate-400 hover:text-admin-primary transition-colors">
                <span class="material-symbols-outlined">storefront</span>
                <span class="text-[10px] font-medium uppercase tracking-tight">Vendors</span>
            </a>
            <a href="#" class="flex flex-col items-center gap-1 text-slate-400 hover:text-admin-primary transition-colors">
                <span class="material-symbols-outlined">group</span>
                <span class="text-[10px] font-medium uppercase tracking-tight">Users</span>
            </a>
            <a href="#" class="flex flex-col items-center gap-1 text-slate-400 hover:text-admin-primary transition-colors">
                <span class="material-symbols-outlined">settings</span>
                <span class="text-[10px] font-medium uppercase tracking-tight">Settings</span>
            </a>
        </div>
        <div class="h-6 w-full"></div>
    </nav>
</div>
{% endblock %}
