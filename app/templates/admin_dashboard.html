{% extends "base.html" %}

{% block title %}Admin Dashboard - SheSafe{% endblock %}

{% block content %}
<div class="bg-blush-white dark:bg-background-dark min-h-screen -mx-5 -my-6 overflow-x-hidden">
    <!-- Top Navigation Bar -->
    <header
        class="sticky top-0 z-50 bg-blush-white/80 dark:bg-background-dark/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800">
        <div class="flex items-center justify-between p-4 pb-3">
            <div class="flex items-center gap-3">
                <div
                    class="size-10 rounded-full bg-navy-trust/20 flex items-center justify-center overflow-hidden border border-navy-trust/30">
                    <span class="material-symbols-outlined text-navy-trust">admin_panel_settings</span>
                </div>
                <div>
                    <h2 class="text-sm font-medium text-slate-500 dark:text-slate-400 leading-none mb-1">Welcome back,
                    </h2>
                    <h1 class="text-lg font-bold leading-none">{{ user.name }}</h1>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <a href="{{ url_for('main.logout') }}"
                    class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors">
                    <span class="material-symbols-outlined">logout</span>
                </a>
            </div>
        </div>
    </header>

    <main class="px-4 py-4 pb-24 max-w-[430px] mx-auto">
        <!-- Section Title -->
        <div class="mb-4">
            <h2 class="text-xl font-bold tracking-tight text-navy-trust dark:text-white">Overview Dashboard</h2>
            <p class="text-xs text-slate-500 dark:text-slate-400">Platform activity and management</p>
        </div>

        <!-- Metrics Grid -->
        <div class="grid grid-cols-2 gap-3 mb-6">
            <div
                class="flex flex-col gap-2 rounded-2xl p-4 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-navy-trust">groups</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Total
                        Users</p>
                    <p class="text-2xl font-bold mt-1 text-navy-trust dark:text-white">{{ user_count }}</p>
                </div>
            </div>
            <div
                class="flex flex-col gap-2 rounded-2xl p-4 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-primary-pink">storefront</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Total
                        Vendors</p>
                    <p class="text-2xl font-bold mt-1 text-navy-trust dark:text-white">{{ vendor_count }}</p>
                </div>
            </div>
            <div
                class="flex flex-col gap-2 rounded-2xl p-4 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-amber-500">verified</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Verified
                    </p>
                    <p class="text-2xl font-bold mt-1 text-navy-trust dark:text-white">{{ verified_vendors|length }}</p>
                </div>
            </div>
            <div
                class="flex flex-col gap-2 rounded-2xl p-4 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm">
                <div class="flex justify-between items-start">
                    <span class="material-symbols-outlined text-sos-red">pending_actions</span>
                </div>
                <div>
                    <p class="text-slate-500 dark:text-slate-400 text-xs font-medium uppercase tracking-wider">Pending
                    </p>
                    <p class="text-2xl font-bold mt-1 text-navy-trust dark:text-white">{{ pending_vendors|length }}</p>
                </div>
            </div>
        </div>

        <!-- Pending Vendor Requests Section -->
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-bold text-navy-trust dark:text-white">Pending Vendor Requests</h3>
        </div>

        <div class="flex flex-col gap-3">
            {% if pending_vendors %}
            {% for vendor in pending_vendors %}
            <div
                class="flex flex-col bg-white dark:bg-slate-800 p-4 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm">
                <div class="flex items-center gap-4 mb-4">
                    <div
                        class="bg-primary-pink/10 rounded-full h-12 w-12 flex-shrink-0 flex items-center justify-center">
                        <span class="material-symbols-outlined text-primary-pink">storefront</span>
                    </div>
                    <div class="flex-1 overflow-hidden">
                        <p class="text-base font-bold truncate text-navy-trust dark:text-white">{{ vendor.business_name
                            }}</p>
                        <p class="text-slate-500 dark:text-slate-400 text-sm truncate">{{ vendor.category }} â€¢ {{
                            vendor.user.name }}</p>
                    </div>
                </div>
                <div class="flex gap-2">
                    <form method="POST" action="{{ url_for('main.approve_vendor', vendor_id=vendor.id) }}"
                        class="flex-1">
                        <button type="submit"
                            class="w-full h-10 bg-navy-trust text-white rounded-2xl text-sm font-bold transition-opacity hover:opacity-90 active:scale-[0.98]">
                            Approve
                        </button>
                    </form>
                    <form method="POST" action="{{ url_for('main.reject_vendor', vendor_id=vendor.id) }}" class="flex-1"
                        onsubmit="return confirm('Are you sure you want to reject this vendor?');">
                        <button type="submit"
                            class="w-full h-10 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-2xl text-sm font-bold transition-colors hover:bg-slate-50 dark:hover:bg-slate-700 active:scale-[0.98]">
                            Reject
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div
                class="flex flex-col bg-white dark:bg-slate-800 p-8 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm text-center">
                <span
                    class="material-symbols-outlined text-slate-300 dark:text-slate-600 text-5xl mb-3">check_circle</span>
                <p class="text-slate-500 dark:text-slate-400 font-medium">No pending vendor requests</p>
                <p class="text-slate-400 dark:text-slate-500 text-sm mt-1">All caught up!</p>
            </div>
            {% endif %}
        </div>

        <!-- All Vendors Section -->
        <div class="flex items-center justify-between mb-4 mt-8">
            <h3 class="text-lg font-bold text-navy-trust dark:text-white">All Vendors</h3>
            <span class="text-slate-500 text-sm">{{ all_vendors|length }} total</span>
        </div>

        <div class="flex flex-col gap-3">
            {% for vendor in all_vendors[:5] %}
            <div
                class="flex items-center gap-4 bg-white dark:bg-slate-800 p-4 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm">
                <div class="bg-primary-pink/10 rounded-full h-10 w-10 flex-shrink-0 flex items-center justify-center">
                    <span class="material-symbols-outlined text-primary-pink text-xl">storefront</span>
                </div>
                <div class="flex-1 overflow-hidden">
                    <p class="text-sm font-bold truncate text-navy-trust dark:text-white">{{ vendor.business_name }}</p>
                    <p class="text-slate-500 dark:text-slate-400 text-xs truncate">{{ vendor.category }}</p>
                </div>
                <div class="flex items-center gap-2">
                    {% if vendor.is_verified %}
                    <span class="material-symbols-outlined text-emerald-500 text-xl">verified</span>
                    {% endif %}
                    {% if vendor.is_active %}
                    <span class="h-2 w-2 rounded-full bg-emerald-500"></span>
                    {% else %}
                    <span class="h-2 w-2 rounded-full bg-slate-300"></span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </main>

    <!-- Bottom Navigation Bar -->
    <nav
        class="fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur-lg border-t border-slate-200 dark:border-slate-800 z-50">
        <div class="flex justify-around items-center px-2 py-3 max-w-md mx-auto">
            <a href="{{ url_for('main.admin_dashboard') }}" class="flex flex-col items-center gap-1 text-navy-trust">
                <span class="material-symbols-outlined fill-1">dashboard</span>
                <span class="text-[10px] font-bold uppercase tracking-tight">Overview</span>
            </a>
            <a href="#" class="flex flex-col items-center gap-1 text-slate-400 hover:text-navy-trust transition-colors">
                <span class="material-symbols-outlined">storefront</span>
                <span class="text-[10px] font-medium uppercase tracking-tight">Vendors</span>
            </a>
            <a href="#" class="flex flex-col items-center gap-1 text-slate-400 hover:text-navy-trust transition-colors">
                <span class="material-symbols-outlined">group</span>
                <span class="text-[10px] font-medium uppercase tracking-tight">Users</span>
            </a>
            <a href="#" class="flex flex-col items-center gap-1 text-slate-400 hover:text-navy-trust transition-colors">
                <span class="material-symbols-outlined">account_balance_wallet</span>
                <span class="text-[10px] font-medium uppercase tracking-tight">Revenue</span>
            </a>
            <a href="#" class="flex flex-col items-center gap-1 text-slate-400 hover:text-navy-trust transition-colors">
                <span class="material-symbols-outlined">settings</span>
                <span class="text-[10px] font-medium uppercase tracking-tight">Settings</span>
            </a>
        </div>
        <div class="h-6 w-full"></div>
    </nav>
</div>
{% endblock %}